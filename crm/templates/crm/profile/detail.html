{% extends 'crm/crm_base.html' %}

{% load i18n %}
{% load gravatar %}

{% block content %}
<div class="row">
    <div class="small-12 columns">
        <div class="card">
            <h3>{% blocktrans with username=request.user.username %}{{ username }}'s Profile{% endblocktrans %}</h3>
            {% if request.user.person %}
                {% with u=request.user p=request.user.person %}
                    <hr/>
                    <h4>{% trans 'User profile' %} <a class="button float-right">{% trans 'edit' %}</a></h4>
                    <div class="row">
                    <div class="small-12 medium-6 columns">
                    <ul class="profile-list">
                        <li><b>{% trans 'Username' %}:</b> {{ u.username }}</li>
                        <li><b>{% trans 'E-mail address' %}:</b> {{ u.email }}</li>
                        <li><b>{% trans 'Account roles' %}:</b>
                            <ul>
                                {% if u.is_active %}<li>{% trans 'Active' %}</li>{% endif %}
                                {% if u.is_staff %}<li>{% trans 'Staff' %}</li>{% endif %}
                                {% if u.is_superuser %}<li>{% trans 'Superuser' %}</li>{% endif %}
                                {% if not u.is_active and not u.is_staff and not u.is_superuser %}<li>{% trans 'No roles' %}</li>{% endif %}
                            </ul>
                        </li>
                    <li><b>{% trans 'Account groups' %}:</b>
                        <ul>
                            {% for group in u.groups_set %}
                                <li>{{ group }}</li>
                            {% empty %}
                                <li>{% trans 'No groups' %}</li>
                            {% endfor %}
                        </ul>
                    </li>
                    </ul>
                    </div>
                    <div class="small-12 medium-6 columns">
                        <span class="float-right">Gravatar</span>
                        <a href="{% gravatar_profile_url u.email %}" target="_blank"><img title="Gravatar" class="thumbnail float-right" src="{% gravatar_url u.email 150 %}" /></a>
                    </div>
                    </div>
                    <hr/>
                    <h4>{% trans 'Customer profile' %} <a class="button float-right">{% trans 'edit' %}</a></h4>
                    <ul class="profile-list">
                        <li><b>{% trans 'Name' %}:</b> {{ p.name }}</li>
                        <li><b>{% trans 'E-mail address' %}:</b> {{ p.email }}</li>
                        <li><b>{% trans 'Address' %}:</b> {{ p.address|default:"-" }}</li>
                        <li><b>{% trans 'Zip code' %}:</b> {{ p.zip_code|default:"-" }}</li>
                        <li><b>{% trans 'City' %}:</b> {{ p.city|default:"-" }}</li>
                        <li><b>{% trans 'Phone number' %}:</b> {{ p.phone|default:"-" }}</li>
                        <li><b>{% trans 'Memo' %}:</b> {{ p.memo|default:"-" }}</li>
                        <li><b>{% trans 'Customer groups' %}:</b>
                            <ul>
                                {% for type in p.types_set %}
                                    <li>{{ type }}</li>
                                {% empty %}
                                    <li>{% trans 'No groups' %}</li>
                                {% endfor %}
                            </ul>
                        </li>
                    </ul>
                {% endwith %}
            {% else %}
                <div class="callout warning">
                    <h5>{% trans 'You do not have a profile yet.' %}</h5>
                    <p>{% trans 'There is no customer profile linked to you swipe account yet.' %}</p>
                    {% if request.user.is_admin %}
                        {% url 'user_profile_link' request.user.id as profile_url %}
                        <p>{% blocktrans with profile_url=profile_url %}Please go to the <a href="{{ profile_url }}">Person Linking page</a> to link a customer to this account.{% endblocktrans %}</p>
                    {% else %}
                        <p>{% trans 'Please ask one of the swipe administrators to link your customer to your swipe account.' %}</p>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}